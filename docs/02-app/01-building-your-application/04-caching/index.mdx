---
title: Caching in Next.js
nav_title: Caching
description: An overview of caching mechanisms in Next.js.
---

Next.js has a few caching mechanisms to improve your application's performance. This page provides an overview of the different mechanisms, how they affect each other, and how you can use them.

Please note that some caching heurestics are automatic, while others can be manually configured. Caching is also split between rendering output, router cache, and data, client and server environments.

## Overview

| Mechanism             | What is cached?                                                        | Where is it cached? | Why is it cached?                               | Duration                                                                                                           | APIs                                                                         |
| --------------------- | ---------------------------------------------------------------------- | ------------------- | ----------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------- |
| Rendering Cache       | Pre-rendered Client Components, and Rendered Server Components Payload | Server (CDN)        | Reduce the rendering cost.                      | Persistent or revalidate lifetime                                                                                  | Route Segment Config, and Dynamic Functions                                  |
| Router Cache          | Rendered Server Component Payload                                      | Client (in-memory)  | Improve navigation performance.                 | Single Session (cleared by hard navigation or refresh), or 30s for dynamic routes, and 5 minutes for static routes | <Link>, router.prefetch, router.refresh, revalidatePath, revalidateTag       |
| Data Cache            | Result of data requests                                                | Server (CDN)        | Store data across user requests and deployments | Persistent or revalidate lifetime                                                                                  | fetch.cache, fetch.revalidate, unstable_cache, revalidatePath, revalidateTag |
| Request Deduplication | Result of data requests                                                | Server (in-memory)  | Reduce data store calls                         | Per render pass / request lifecycle                                                                                | unstable_cache                                                               |

## Request Deduplication

- Change in React's API design
- Allows us to think about components in isolation
- Fetch liberally without worrying about performance
- Rely on the system to handle optimization
- Replacement for passing data as from layout to page

Request deduplication is an optimization that takes **multiple** requests for the same data and only makes a **single** request to the data source. This is done by storing the result of the first request in a temporary cache, and returning the cached result for subsequent requests.

For example, if you need to fetch the same data (e.g. current user) in multiple components in a tree, Next.js will temporarily cache `fetch` requests that have the same input, and only make one request to the data source.

<Image
  alt="Fetch Request Deduplication"
  srcLight="/docs/light/deduplicated-fetch-requests.png"
  srcDark="/docs/dark/deduplicated-fetch-requests.png"
  width="1600"
  height="857"
/>

> **Good to know:**
>
> You may also hear this concept referred to as **memoization**. This is a similar term that applies to the return value of a function call, whereas **request deduplication** applies specifically to the result of a data request.

### Duration

The cache lasts the lifetime of a server request until the rendering process completes.

### APIs

#### Extended `fetch` API

Request deduplication is automatically applied to `fetch` requests used in Layouts, Pages, Server Components, `generateMetadata`, and `generateStaticParams` across the same render pass.

Internally, `fetch` uses React's `cache` function.

#### React `cache`

React's `cache` function allows you to memoize the return value of a function, allowing you to call the same function multiple times while only executing it once.

You can use it to manually deduplicate data requests for use cases when the `fetch` API is not suitable. For example, database clients, CMS clients, or GraphQL.

```tsx filename="utils/get-user.ts" switcher
import { cache } from 'react'

export const getUser = cache(async (id: string) => {
  const user = await db.user.findUnique({ id })
  return user
})
```

```jsx filename="utils/get-user.js" switcher
import { cache } from 'react'

export const getUser = cache(async (id) => {
  const user = await db.user.findUnique({ id })
  return user
})
```

> **Good to know:**
>
> - You can use `cache` to memoize any function, not just data requests.
> - Next.js uses `cache` to memoize data requests on the server, however, `cache` can also be used on the client.
